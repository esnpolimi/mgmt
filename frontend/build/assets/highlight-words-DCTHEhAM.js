const u=e=>t=>t!==null&&typeof t=="object"&&e in t,c=u("match"),g=e=>typeof e<"u";function m({curr:e,next:t,prev:n,clipBy:s=3}){const o=e.text.split(" "),i=o.length;if(e.match||s>=i)return e.text;const r="...";return g(t)&&g(n)&&c(n)&&c(t)?i>s*2?[...o.slice(0,s),r,...o.slice(-s)].join(" "):e.text:g(t)&&c(t)?[r,...o.slice(-s)].join(" "):g(n)&&c(n)?[...o.slice(0,s),r].join(" "):e.text}const x=e=>e.replace(/[|\\{}()[\]^$+*?.-]/g,t=>`\\${t}`),w=e=>e.replace(/\s{2,}/g," ").split(" ").join("|"),E=({terms:e,matchExactly:t=!1})=>{if(typeof e!="string")throw new TypeError("Expected a string");const n=x(e.trim());return`(${t?n:w(n)})`},d=({terms:e,matchExactly:t=!1})=>{try{const n=/^([/~@;%#'])(.*?)\1([gimsuy]*)$/.exec(e);return n?new RegExp(n[2],n[3]):new RegExp(E({terms:e,matchExactly:t}),"ig")}catch{throw new TypeError("Expected terms to be either a string or a RegExp!")}};let f=36,h="";for(;f--;)h+=f.toString(36);function p(e=11){let t="",n=e;for(;n--;)t+=h[Math.random()*36|0];return t}const R=e=>e.length>0,T=({text:e,query:t,clipBy:n,matchExactly:s=!1})=>{const o=typeof t=="string"?t.trim():t;if(o==="")return[{key:p(),text:e,match:!1}];const i=d({terms:t,matchExactly:s});return e.split(i).filter(R).map(r=>({key:p(),text:r,match:s?r.toLowerCase()===o.toLowerCase():i.test(r)})).map((r,a,l)=>({...r,...typeof n=="number"&&{text:m({curr:r,...a<l.length-1&&{next:l[a+1]},...a>0&&{prev:l[a-1]},clipBy:n})}}))};export{T as h};
